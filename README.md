# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом
- src/components/model/ - папка с кодом слоя данных
- src/components/view/ - папка с кодом слоя представления

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## Данные и типы данных
Данные карточки
```
type LotCategories =
    'софт-скилс'
	'другое'
	'дополнительное'
	'кнопка'
	'хард-скил';  
```
```
interface LotCard {
	id: string; //Id лота
	title: string; //заголовок лота
    description: string; //описание лота
    image: string; //картинка лота
	price: number | null; //цена лота
	category: LotCategories; //кактегория лота
}
```
Данные пользователя 
```
interface OrderForm {
    payment: string; 
	address: string;
	email: string;
	phone: string;
}
```
## Документация
Модель данных выполнена в паттерне MVP (Model-View-Presenter):
- Базовый код
- Слой данных
- Компоненты представления 

## Базовый код

### Класс `API`
Класс доступа к веб-серверу. Обеспечивает выполнение запросав GET, POST

Методы:
- `get` - выполняет GET запрос
- `post` - выполняет POST запрос 

### Класс `Component`
Класс является дженериком и родителем всех компонентов слоя представления. Реализует базовые элементы работы с элементами, такие как переключение классов, установка текста у элемента и т.д.

### Класс `Form`
Класс для базовых форм. Является родительским для классов `OrderFirst`,`OrderSecond`\
Поля:
- _submit: HTMLButtonElement - кнопка отправки формы
- _errors: HTMLElement - контейнер для ошибок 

Методы: 
- `render` - метод рендеринга формы
- `set errors` - сеттер для установки сообщений об ошибках
- `set valid` - сеттер для установки валидности формы
- `onInputChange()` - метод обработки изменения поля ввода

### Класс `Modal`
Реалезация модальных окон\
Поля класса:
- _content: HTMLTemplateElement - содержимое модального окна
- _closeButton: HTMLButtonElement - закрытие модального окна

Методы: 
- `open` - открытие модального окна
- `close` - закрытие модального окна
- `set content` - устанавливает содержимое попапа

### Класс `EventEmitter`
Позволяет подписываться на события и уведомлять о наступлении события\
Методы:
- `on` - установить оброботчик на событие 
- `off` - снять обработчик с события
- `emit` - инициировать событие
- `trigger` - коллбек триггер, генерирующий событие при вызове

- `onAll` - Слушать все события
- `offAll` - Сбросить все обработчики

## Слой данных(Model)

### Класс `CardsModel`
Класс для хранения данных товаров\
Поля:
- id: string - ID товара
- _cards: ICard[] - массив всех товаров

Методы:
- `set cards(cards: ICard[])` - сохраняет список товаров
- `get cards(): ICard[]` - возвращает список товаров
- `getCardById(id: string)` - возвращает товар по id

### Класс `CartModel`
Класс для хранения данных корзины товаров\
Поля:
- items: ICard[] - массив товаров в корзине

Методы:
- `addToCart(card: ICard) :void` - добавляет товар в корзину
- `removeFromCart(id: string) :void` - удаляет товар из корзины
- `clearCart() :void` - очищает всю корзину 
- `totalPrice() :number` - сумма всех заказов
- `getItems(): ICard[]` - возвращает массив товаров
- `hasItem(id: string) :boolean` - проверяет, есть ли товар с конкретным ID
- `getItemCountById(id: string) :number` - возвращает количество товара в корзине по ID
- `getItemCount() :number` - общее количество товаров в корзине

### Класс `FormModel`
Класс для хранения данных пользователя\
Поля:
- address :string - адрес доставки
- payment :string - способ оплаты

- phone :string - телефон для связи
- email :string - почта для связи

- _valid :boolean - валидация
- _currentStep: 'order' | 'contacts' = 'order' - для перехода на шаг 1 или шаг 2
- _initialLoad: boolean - проверка на начальную загрузку полей
- _hasAddressInteraction :boolean - проверка не было взаимодействия и данных с адресом
- _hasPaymentInteraction :boolean` - проверка не было взаимодействия и данных с оплатой

Методы:
- `setOrderData(data :IOrderForm)` - устанавливает контактные данные
- `getFormData() :IOrderForm` - возвращает введенные контактные данные
- `setStep(step: 'order' | 'contacts')` - устанавливает текущий шаг для валидации
- `get valid(): boolean` - проверяет корректность введённых данных пользователя
- `reset()` - очистка данных формы

## Компоненты представления
Классы представления отвечают за отображение внутри контейнера (DOM-элемент) передаваемых в них данных

### Класс `Page`
Класс представления, отображает главную страницу\
Поля класса:
- _catalog: HTMLElement - контейнер для товаров
- _basket: HTMLElement - корзина на главной странице
- _wrapper: HTMLElement - обёртка страницы
- _counter: HTMLSpanElement - счетчик товаров в корзине

Методы:
- `counter` - отображение количества товаров в корзине
- `catalog` - элемент отображения всех доступных карточек

### Класс `Card `
Класс с информацией карточки товара\
Поля класса:
- _id: HTMLSpanElement - ID лота
- _title: HTMLTitleElement - заголовок лота
- _description: HTMLParagraphElement - описание лота
- _image: HTMLImageElement - картинка лота
- _price: HTMLSpanElement - цена лота
- _category: HTMLSpanElement - категория лота

Методы:
- `set id :string` - устанавливает ID лота
- `set title :string` - устанавливает заголовок лота
- `set image :string` - устанавливает картинку лота
- `set price :number` - устанавливает цену лота
- `set category :string` - устанавливает категорию лота
- `getCategoryClass(category: categories) :string` - устонавливает категорию

### Класс `Basket`
Класс корзины товаров.\
Поля:
- _button: HTMLButtonElement - кнопка оформления. `button` вызывает событие `order_payment:open`
- _basketList: HTMLElement - список товаров
- _totalPrice: HTMLElement - общая стоимость корзины

Методы:
- `set items(items: HTMLElement[])` - отображает список товаров
- `set selected(items :string[])` - кнопка удаления товара
- `set total(total :number)` - общяя стоимость товаров

### Класс `OrderFirstStep`
Класс формы оформления заказа с оплатой и адрессом\
Поля:
- onlineButton: HTMLButtonElement - кнопка для онлайн оплаты
- offlineButton: HTMLButtonElement - кнопка для оплаты при получении
- submitButton: HTMLButtonElement - кнопка подтверждения
- addressInput: HTMLInputElement - поле формы для адреса
- _errors: HTMLElement - для ошибок валидации

Методы:
- `set address` - адрес дооставки
- `set valid(value: boolean)` - валидность для активности кнопки
- `set errors(value :string)` - для вывода ошибок
- `render(data: Partial): HTMLElement` - рендер

### Класс `OrderSecondStep`
Класс формы оформления заказа с почтой и телефоном\
Поля:
- _email :HTMLInputElement - поле ввода email
- _phone :HTMLInputElement - поле ввода номера телефона
- _payButton :HTMLButtonElement - кнопка "Оплатить"
- _errors: HTMLElement - ошибки валидации полей

Методы:
- `set email` - email пользователя
- `set phone` - номер телефона пользователя
- `set valid(value :boolean)` - валидность для активности кнопки
- `set errors(value :string)` - для вывода ошибок
- `render(data: Partial): HTMLElement` - рендер

### Класс `OrderSuccess`
Класс окна успешной покупки\
Поля: 
- _totalPrice :HTMLElement - стоимость заказа
- _closeButton :HTMLButtonElement - кнопка закрытия окна 

Методы:
- `set total` - отоброженеи стоимости заказа

## Компоненты, их функции и связи с другими компонентами 

### `Главная страница`
Показывает массив карточек товаров на странице, можно открыть `карточку товара` и `корзину товаров`. Получает данные массива карточек и колличества товаров в корзине

### `Карточка товара`
Показывает карточку с информацией о товаре, также можно отправить товар в `корзину` нажатием на кнопку "Купить"

### `Корзина`
Показывает все товары в корзине, отображает полную стоимость Корзины, имеет кнопку "Удалить" которая убирает товар из корзины, кнопка "Оформить" отправляет пользователя на `Первый Шаг Оформления заказа`

### `Первый Шаг Оформления заказа`
Показывает поле адреса доставки, также отображает форму которая позваляет выбрать пользователю способ оплаты, кнопка "Далее" открывает попап со `Вторым Шагом Оформления Заказа`, если поле проходить валидность

### `Второй Шаг Оформления заказа`
Показывает форму ввода e-mail и номера телефона пользователя, кнопка "Оплатить" завершает оформление заказа и открывает попап `Успешного Оформления заказа`, если поле проходит валидность.

### `Успешное оформление заказа`
Сообщение об успешном оформлении заказа, кнопка "За новыми покупками!" закрывает попап, переход на Главную страницу, корзина товаров очищается.







